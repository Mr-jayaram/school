<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Reports & Analytics</title>
    <link rel="shortcut icon" href="https://jaiinfo.tech/logo/logo_only.png">
    <!-- Bootstrap CSS -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts (Example: Poppins for a similar look) -->
    <link href="assets/css/css2.css" rel="stylesheet">
    <!-- Bootstrap Icons CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

    <!-- Link to your external style.css file -->
    <link rel="stylesheet" href="assets/css/style.css">

    <style>
        /* Custom styles for report page */
        .report-card-item {
            padding: 20px;
            border-radius: 8px;
            color: #fff;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease-in-out;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .report-card-item:hover {
            transform: translateY(-5px);
        }
        .report-card-item .value {
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 5px;
        }
        .report-card-item .label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* Color variations for cards */
        .report-card-item.total { background-color: #6f42c1; }
        .report-card-item.students { background-color: #007bff; }
        .report-card-item.staff { background-color: #28a745; }
        .report-card-item.attendance { background-color: #fd7e14; }

        .report-section {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }
        .report-section .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        .report-section h5 {
            margin-bottom: 0;
            color: #333;
        }
    </style>

</head>
<body>
    <div class="wrapper">
        <!-- Sidebar -->
       <aside class="sidebar" id="sidebar">
            <div class="logo">
                <span>Admin</span>
            </div>
            <nav class="menu">
                <a href="index.html" class="menu-item">
                    <i class="bi bi-speedometer2 menu-icon"></i> <span>Dashboard</span>
                </a>

                <a href="javascript:void(0);" class="menu-item menu-item-toggle has-submenu">
                   <i class="bi bi-person-badge menu-icon"></i> <span>Add Member</span> <span class="arrow-icon">&#9660;</span>
                </a>
                <div class="submenu">
                    <a href="staff.html" class="submenu-item">Staffs</a>
                    <a href="student.html" class="submenu-item">Students</a>
                </div>

                <a href="attendance.html" class="menu-item">
                    <i class="bi bi-calendar-check menu-icon"></i> <span>Attendance</span>
                </a>
               

                <a href="javascript:void(0);" class="menu-item menu-item-toggle has-submenu"> <!-- Active Reports link -->
                    <i class="bi bi-graph-up-arrow menu-icon sub-menu-have"></i> <span>Reports</span> <span class="arrow-icon">&#9660;</span>
                </a>
                <div class="submenu show"> <!-- Keep submenu open for active page -->
                    <a href="report.html" class="submenu-item active">Student Reports</a>
                    <a href="report.html" class="submenu-item">Staff Reports</a>
                    <a href="report.html" class="submenu-item">Attendance Reports</a>
                </div>

                <!-- <a href="javascript:void(0);" class="menu-item">
                    <i class="bi bi-trophy-fill menu-icon"></i> <span>Student Performance</span>
                </a> -->
                <a href="annoncement.html" class="menu-item">
                    <i class="bi bi-chat-dots-fill menu-icon"></i> <span>Announcements</span>
                </a>
                <a href="settings.html" class="menu-item">
                    <i class="bi bi-gear-fill menu-icon"></i> <span>Settings</span>
                </a>
            </nav>

            
        </aside>

        <!-- Sidebar Overlay (for mobile) -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Main Content Area -->
        <main class="main-content">
            <header class="header">
                <div class="d-flex align-items-center">
                    <button class="menu-toggle" id="menuToggle" aria-label="Toggle mobile menu">
                        &#9776; <!-- Hamburger icon -->
                    </button>
                    <div>
                        <i class="bi bi-search search-icon"></i>
                    </div>
                </div>
                <div class="user-profile">
                    <img src="assets/img/logo/user.png" alt="Avatar">
                    <div class="user-info">
                        <h6>Jon Principal</h6>
                        <span>School Admin</span>
                    </div>
                </div>
            </header>

            <section class="dashboard-filters report-filters">
                <div class="filter-group">
                    <label for="reportYearFilter">Academic Year</label>
                    <select id="reportYearFilter">
                        <option value="2024-2025">2024-2025</option>
                        <option value="2023-2024">2023-2024</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="reportTypeFilter">Report Type</label>
                    <select id="reportTypeFilter">
                        <option value="All">All Reports</option>
                        <option value="Students">Student Reports</option>
                        <option value="Staff">Staff Reports</option>
                        <option value="Attendance">Attendance Reports</option>
                    </select>
                </div>
                <div class="filter-group search-group">
                    <label for="reportSearch">Search Reports</label>
                    <input type="text" class="form-control" id="reportSearch" placeholder="Search report titles...">
                </div>
                <div class="action-buttons ms-auto">
                    <!-- No "Add New" button for reports, but maybe a "Generate Custom Report" in future -->
                </div>
            </section>

            <section class="report-overview-section">
                <div class="card-title">
                    Reports Overview
                    <div class="filter-display">
                        <span id="overviewFilterText">2024-2025 / All Reports</span> <span class="dropdown-arrow">â–¼</span>
                    </div>
                </div>
                <div class="row g-3 report-overview-cards">
                    <div class="col-lg-3 col-md-6">
                        <div class="overview-card-item orange total">
                            <div class="value" id="totalReportsCard">3</div>
                            <div class="label">Total Report Categories</div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <div class="overview-card-item green students">
                            <div class="value" id="studentReportsCard">1</div>
                            <div class="label">Student Reports</div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <div class="overview-card-item blue staff">
                            <div class="value" id="staffReportsCard">1</div>
                            <div class="label">Staff Reports</div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <div class="overview-card-item red attendance">
                            <div class="value" id="attendanceReportsCard">1</div>
                            <div class="label">Attendance Reports</div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="reports-list-section mt-4">
                <!-- Student Reports Section -->
                <div class="report-section" id="student-reports">
                    <div class="section-header">
                        <h5>Student Enrollment Report (2024-2025)</h5>
                        <button class="btn btn-success btn-sm download-excel-btn" data-report-type="student-enrollment">
                            <i class="bi bi-file-earmark-excel me-2"></i>Download Excel
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Grade</th>
                                    <th>Department</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="studentReportTableBody">
                                <!-- Data will be loaded by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Staff Reports Section -->
                <div class="report-section" id="staff-reports">
                    <div class="section-header">
                        <h5>Staff Directory Report (2024-2025)</h5>
                        <button class="btn btn-success btn-sm download-excel-btn" data-report-type="staff-directory">
                            <i class="bi bi-file-earmark-excel me-2"></i>Download Excel
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Department</th>
                                    <th>Role</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="staffReportTableBody">
                                <!-- Data will be loaded by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Attendance Reports Section -->
                <div class="report-section" id="attendance-reports">
                    <div class="section-header">
                        <h5>Monthly Attendance Summary (September 2025)</h5>
                        <button class="btn btn-success btn-sm download-excel-btn" data-report-type="attendance-summary">
                            <i class="bi bi-file-earmark-excel me-2"></i>Download Excel
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Class</th>
                                    <th>Total Students</th>
                                    <th>Present</th>
                                    <th>Absent</th>
                                    <th>Tardy</th>
                                </tr>
                            </thead>
                            <tbody id="attendanceReportTableBody">
                                <!-- Data will be loaded by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- No reports found message -->
                <div id="noReportsMessage" class="alert alert-info text-center d-none" role="alert">
                    No reports match your current filters.
                </div>
            </section>
        </main>
    </div>

    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Sidebar and Layout Logic (Copied from previous pages) ---
            const menuToggleItems = document.querySelectorAll('.sidebar .menu-item-toggle.has-submenu');
            const allNavItems = document.querySelectorAll('.sidebar .menu-item, .sidebar .submenu-item');
            const sidebar = document.getElementById('sidebar');
            const menuToggleButton = document.getElementById('menuToggle');
            const sidebarOverlay = document.getElementById('sidebarOverlay');
            const desktopSidebarToggle = document.getElementById('desktopSidebarToggle');

            // --- Page Specific Elements ---
            const reportYearFilter = document.getElementById('reportYearFilter');
            const reportTypeFilter = document.getElementById('reportTypeFilter');
            const reportSearch = document.getElementById('reportSearch');

            const totalReportsCard = document.getElementById('totalReportsCard');
            const studentReportsCard = document.getElementById('studentReportsCard');
            const staffReportsCard = document.getElementById('staffReportsCard');
            const attendanceReportsCard = document.getElementById('attendanceReportsCard');
            const overviewFilterText = document.getElementById('overviewFilterText');

            const studentReportTableBody = document.getElementById('studentReportTableBody');
            const staffReportTableBody = document.getElementById('staffReportTableBody');
            const attendanceReportTableBody = document.getElementById('attendanceReportTableBody');
            const noReportsMessage = document.getElementById('noReportsMessage');

            // --- Sidebar Functionality (common to all pages) ---
            function closeAllSubmenus(exceptSubmenu = null) {
                document.querySelectorAll('.sidebar .submenu.show').forEach(submenu => {
                    if (submenu !== exceptSubmenu) {
                        submenu.style.maxHeight = '0';
                        submenu.classList.remove('show');
                        const parentToggle = submenu.previousElementSibling;
                        if (parentToggle) {
                            parentToggle.classList.remove('open');
                        }
                    }
                });
            }

            menuToggleItems.forEach(item => {
                item.addEventListener('click', (event) => {
                    event.preventDefault();
                    const submenu = item.nextElementSibling;
                    if (!sidebar.classList.contains('sidebar-collapsed') || window.innerWidth < 992) {
                        closeAllSubmenus(submenu);
                        if (submenu && submenu.classList.contains('submenu')) {
                            item.classList.toggle('open');
                            if (submenu.classList.contains('show')) {
                                submenu.style.maxHeight = '0';
                                submenu.classList.remove('show');
                            } else {
                                submenu.style.maxHeight = submenu.scrollHeight + 'px';
                                submenu.classList.add('show');
                            }
                        }
                    }
                });
            });

            allNavItems.forEach(item => {
                item.addEventListener('click', (event) => {
                    document.querySelectorAll('.sidebar .menu-item, .sidebar .submenu-item').forEach(mi => mi.classList.remove('active'));
                    (item.closest('.menu-item') || item).classList.add('active');

                    if (item.classList.contains('submenu-item')) {
                        const parentSubmenu = item.closest('.submenu');
                        if (parentSubmenu) {
                            parentSubmenu.style.maxHeight = parentSubmenu.scrollHeight + 'px';
                            parentSubmenu.classList.add('show');
                            const parentToggle = parentSubmenu.previousElementSibling;
                            if (parentToggle && parentToggle.classList.contains('menu-item-toggle')) {
                                parentToggle.classList.add('open');
                            }
                        }
                    } else {
                        if (!item.closest('.menu-item').classList.contains('has-submenu') && !sidebar.classList.contains('sidebar-collapsed')) {
                            closeAllSubmenus();
                        }
                    }
                });
            });

            const initiallyActiveItem = document.querySelector('.sidebar .menu-item.active, .sidebar .submenu-item.active');
            if (initiallyActiveItem) {
                if (initiallyActiveItem.classList.contains('submenu-item')) {
                    const parentSubmenu = initiallyActiveItem.closest('.submenu');
                    if (parentSubmenu) {
                        parentSubmenu.style.maxHeight = parentSubmenu.scrollHeight + 'px';
                        parentSubmenu.classList.add('show');
                        const parentToggle = parentSubmenu.previousElementSibling;
                        if (parentToggle && parentToggle.classList.contains('menu-item-toggle')) {
                            parentToggle.classList.add('open');
                        }
                    }
                }
            }

            menuToggleButton.addEventListener('click', () => {
                sidebar.classList.toggle('sidebar-show');
                sidebarOverlay.classList.toggle('overlay-active');
                if (sidebar.classList.contains('sidebar-show')) {
                    sidebar.classList.remove('sidebar-collapsed');
                    document.body.classList.remove('sidebar-collapsed-active');
                }
            });

            sidebarOverlay.addEventListener('click', () => {
                sidebar.classList.remove('sidebar-show');
                sidebarOverlay.classList.remove('overlay-active');
            });

            document.querySelectorAll('.sidebar .menu-item, .sidebar .submenu-item').forEach(item => {
                item.addEventListener('click', () => {
                    if (window.innerWidth < 992 && sidebar.classList.contains('sidebar-show')) {
                        sidebar.classList.remove('sidebar-show');
                        sidebarOverlay.classList.remove('overlay-active');
                    }
                });
            });

            if (desktopSidebarToggle) {
                desktopSidebarToggle.addEventListener('click', () => {
                    const isCollapsed = sidebar.classList.toggle('sidebar-collapsed');
                    document.body.classList.toggle('sidebar-collapsed-active', isCollapsed);
                    if (isCollapsed) {
                        closeAllSubmenus();
                    }
                });
            }

            const handleResize = () => {
                if (window.innerWidth >= 992) {
                    if (sidebar.classList.contains('sidebar-show')) {
                        sidebar.classList.remove('sidebar-show');
                        sidebarOverlay.classList.remove('overlay-active');
                    }
                    if (sidebar.classList.contains('sidebar-collapsed')) {
                        document.body.classList.add('sidebar-collapsed-active');
                    } else {
                        document.body.classList.remove('sidebar-collapsed-active');
                    }
                    if (desktopSidebarToggle) desktopSidebarToggle.classList.remove('d-none');
                } else {
                    sidebar.classList.remove('sidebar-collapsed');
                    document.body.classList.remove('sidebar-collapsed-active');
                    if (desktopSidebarToggle) desktopSidebarToggle.classList.add('d-none');
                }
                document.querySelectorAll('.sidebar .submenu.show').forEach(submenu => {
                    submenu.style.maxHeight = submenu.scrollHeight + 'px';
                });
            };

            window.addEventListener('resize', handleResize);
            handleResize(); // Initial call


            // --- Reports Page Specific Logic ---

            // Simulated Report Data
            const reportsData = {
                '2024-2025': {
                    'student-enrollment': [
                        { ID: 'S24001', Name: 'Alice Johnson', Grade: '10', Department: 'Science', Status: 'Active' },
                        { ID: 'S24002', Name: 'Bob Williams', Grade: '11', Department: 'Mathematics', Status: 'Active' },
                        { ID: 'S24003', Name: 'Charlie Brown', Grade: '9', Department: 'English', Status: 'Active' },
                        { ID: 'S24004', Name: 'Diana Miller', Grade: '10', Department: 'Arts', Status: 'Active' },
                        { ID: 'S24005', Name: 'Eve Davis', Grade: '12', Department: 'History', Status: 'Active' },
                    ],
                    'staff-directory': [
                        { ID: 'T24001', Name: 'Dr. Jane Smith', Department: 'Science', Role: 'Teacher', Status: 'Active' },
                        { ID: 'T24002', Name: 'Mr. John Doe', Department: 'Mathematics', Role: 'Teacher', Status: 'Active' },
                        { ID: 'T24003', Name: 'Ms. Emily White', Department: 'English', Role: 'Teacher', Status: 'Active' },
                        { ID: 'A24001', Name: 'Ms. Sarah Connor', Department: 'Administration', Role: 'Secretary', Status: 'Active' },
                        { ID: 'P24001', Name: 'Mr. David Lee', Department: 'Administration', Role: 'Principal', Status: 'Active' },
                    ],
                    'attendance-summary': [
                        { Date: '2025-09-01', Class: 'Grade 10A', 'Total Students': 30, Present: 28, Absent: 2, Tardy: 1 },
                        { Date: '2025-09-02', Class: 'Grade 11B', 'Total Students': 28, Present: 27, Absent: 1, Tardy: 0 },
                        { Date: '2025-09-03', Class: 'Grade 9C', 'Total Students': 25, Present: 25, Absent: 0, Tardy: 0 },
                        { Date: '2025-09-04', Class: 'Grade 10A', 'Total Students': 30, Present: 29, Absent: 1, Tardy: 0 },
                        { Date: '2025-09-05', Class: 'Grade 12D', 'Total Students': 22, Present: 20, Absent: 2, Tardy: 1 },
                    ]
                },
                '2023-2024': {
                     'student-enrollment': [
                        { ID: 'S23001', Name: 'Frank White', Grade: '9', Department: 'Science', Status: 'Active' },
                        { ID: 'S23002', Name: 'Grace Black', Grade: '10', Department: 'Mathematics', Status: 'Active' },
                    ],
                    'staff-directory': [
                        { ID: 'T23001', Name: 'Dr. Robert Green', Department: 'History', Role: 'Teacher', Status: 'Active' },
                    ],
                    'attendance-summary': [
                        { Date: '2024-03-10', Class: 'Grade 8A', 'Total Students': 28, Present: 26, Absent: 2, Tardy: 0 },
                    ]
                }
            };

            // Report sections mapping
            const reportSections = {
                'student-enrollment': {
                    element: document.getElementById('student-reports'),
                    tableBody: studentReportTableBody,
                    title: 'Student Enrollment Report',
                    headers: ['ID', 'Name', 'Grade', 'Department', 'Status']
                },
                'staff-directory': {
                    element: document.getElementById('staff-reports'),
                    tableBody: staffReportTableBody,
                    title: 'Staff Directory Report',
                    headers: ['ID', 'Name', 'Department', 'Role', 'Status']
                },
                'attendance-summary': {
                    element: document.getElementById('attendance-reports'),
                    tableBody: attendanceReportTableBody,
                    title: 'Monthly Attendance Summary',
                    headers: ['Date', 'Class', 'Total Students', 'Present', 'Absent', 'Tardy']
                }
            };


            function updateReportsPage() {
                const selectedYear = reportYearFilter.value;
                const selectedType = reportTypeFilter.value;
                const searchTerm = reportSearch.value.toLowerCase();

                let visibleReportCount = 0;

                for (const type in reportSections) {
                    const section = reportSections[type];
                    const data = reportsData[selectedYear] ? reportsData[selectedYear][type] : [];
                    let filteredData = data;

                    // Filter by report type (if specific type selected)
                    if (selectedType !== 'All' && type !== selectedType.toLowerCase().replace(' ', '-')) {
                        section.element.classList.add('d-none');
                        continue;
                    }

                    // Filter by search term
                    if (searchTerm) {
                        filteredData = filteredData.filter(row =>
                            Object.values(row).some(value =>
                                String(value).toLowerCase().includes(searchTerm)
                            )
                        );
                    }

                    // Show/hide section based on filtered data presence
                    if (filteredData.length > 0) {
                        section.element.classList.remove('d-none');
                        populateReportTable(section.tableBody, filteredData, section.headers);
                        // Update section header title if it contains year info and filter changes
                        const headerTitleElement = section.element.querySelector('.section-header h5');
                        if (headerTitleElement) {
                             // Basic example, might need more robust title management
                            headerTitleElement.textContent = `${section.title} (${selectedYear})`;
                        }
                        visibleReportCount++;
                    } else {
                        section.element.classList.add('d-none');
                    }
                }

                // Update Overview Cards
                totalReportsCard.textContent = Object.keys(reportsData[selectedYear] || {}).length;
                studentReportsCard.textContent = reportsData[selectedYear]?.['student-enrollment'] ? 1 : 0;
                staffReportsCard.textContent = reportsData[selectedYear]?.['staff-directory'] ? 1 : 0;
                attendanceReportsCard.textContent = reportsData[selectedYear]?.['attendance-summary'] ? 1 : 0;

                overviewFilterText.textContent = `${selectedYear} / ${reportTypeFilter.options[reportTypeFilter.selectedIndex].text}`;

                // Show/hide no reports message
                if (visibleReportCount === 0) {
                    noReportsMessage.classList.remove('d-none');
                } else {
                    noReportsMessage.classList.add('d-none');
                }
            }

            function populateReportTable(tableBodyElement, data, headers) {
                tableBodyElement.innerHTML = ''; // Clear existing rows
                if (data.length === 0) {
                    tableBodyElement.innerHTML = `<tr><td colspan="${headers.length}" class="text-center text-muted py-3">No data available for this report.</td></tr>`;
                    return;
                }
                data.forEach(row => {
                    const tr = document.createElement('tr');
                    headers.forEach(header => {
                        const td = document.createElement('td');
                        td.textContent = row[header] || ''; // Use header name as key
                        tr.appendChild(td);
                    });
                    tableBodyElement.appendChild(tr);
                });
            }


            // --- Excel Download Functionality ---
            function downloadCSV(data, filename) {
                if (!data || data.length === 0) {
                    alert('No data to download.');
                    return;
                }

                const headers = Object.keys(data[0]);
                const csvRows = [];

                // Add header row
                csvRows.push(headers.map(header => `"${header.replace(/"/g, '""')}"`).join(','));

                // Add data rows
                for (const row of data) {
                    const values = headers.map(header => {
                        const value = row[header];
                        // Handle null/undefined values and escape double quotes
                        return `"${(value === null || value === undefined ? '' : String(value)).replace(/"/g, '""')}"`;
                    });
                    csvRows.push(values.join(','));
                }

                const csvString = csvRows.join('\n');
                const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });

                const link = document.createElement('a');
                if (link.download !== undefined) { // Feature detection for HTML5 download attribute
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', filename);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                } else {
                    // Fallback for browsers that don't support download attribute (e.g., IE)
                    alert('Your browser does not support automatic downloads. Please save the following text as a .csv file:\n\n' + csvString);
                }
            }

            // Event listener for all download buttons
            document.querySelectorAll('.download-excel-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const reportType = this.dataset.reportType;
                    const selectedYear = reportYearFilter.value;
                    const dataToDownload = reportsData[selectedYear]?.[reportType];
                    const reportTitle = reportSections[reportType]?.title || 'Report';

                    if (dataToDownload && dataToDownload.length > 0) {
                        downloadCSV(dataToDownload, `${reportTitle.replace(/\s/g, '_')}_${selectedYear}.csv`);
                    } else {
                        alert(`No data available for "${reportTitle}" in ${selectedYear} to download.`);
                    }
                });
            });


            // Event listeners for filters
            reportYearFilter.addEventListener('change', updateReportsPage);
            reportTypeFilter.addEventListener('change', updateReportsPage);
            reportSearch.addEventListener('input', updateReportsPage);

            // Initial call to populate page on load
            updateReportsPage();
        });
    </script>
</body>
</html>